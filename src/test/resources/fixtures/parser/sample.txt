Cloudflare Rules File
  AndExpressionImpl(AND_EXPRESSION)
    MatchesExpressionImpl(MATCHES_EXPRESSION)
      StandardFieldExpressionImpl(STANDARD_FIELD_EXPRESSION)
        PsiElement(identifier)('http')
        PsiElement(.)('.')
        PsiElement(identifier)('host')
      PsiWhiteSpace(' ')
      PsiElement(matches)('matches')
      PsiWhiteSpace(' ')
      PsiElement(stringLiteral)('"(www|api)\.example\.org"')
    PsiWhiteSpace('\n')
    PsiElement(and)('and')
    PsiWhiteSpace(' ')
    NotExpressionImpl(NOT_EXPRESSION)
      PsiElement(not)('not')
      PsiWhiteSpace(' ')
      AndExpressionImpl(AND_EXPRESSION)
        MatchesExpressionImpl(MATCHES_EXPRESSION)
          FunctionExpressionImpl(FUNCTION_EXPRESSION)
            PsiElement(identifier)('lower')
            PsiElement(()('(')
            FunctionArgumentImpl(FUNCTION_ARGUMENT)
              StandardFieldExpressionImpl(STANDARD_FIELD_EXPRESSION)
                PsiElement(identifier)('http')
                PsiElement(.)('.')
                PsiElement(identifier)('request')
                PsiElement(.)('.')
                PsiElement(identifier)('uri')
                PsiElement(.)('.')
                PsiElement(identifier)('path')
            PsiElement())(')')
          PsiWhiteSpace(' ')
          PsiElement(matches)('matches')
          PsiWhiteSpace(' ')
          PsiElement(stringLiteral)('"/(auth|login|logut).*"')
        PsiWhiteSpace('\n')
        PsiElement(and)('and')
        PsiWhiteSpace(' ')
        OrExpressionImpl(OR_EXPRESSION)
          ParenExpressionImpl(PAREN_EXPRESSION)
            PsiElement(()('(')
            PsiWhiteSpace('\n  ')
            OrExpressionImpl(OR_EXPRESSION)
              FunctionExpressionImpl(FUNCTION_EXPRESSION)
                PsiElement(identifier)('any')
                PsiElement(()('(')
                FunctionArgumentImpl(FUNCTION_ARGUMENT)
                  EqExpressionImpl(EQ_EXPRESSION)
                    ArrayAccessExpressionImpl(ARRAY_ACCESS_EXPRESSION)
                      StandardFieldExpressionImpl(STANDARD_FIELD_EXPRESSION)
                        PsiElement(identifier)('http')
                        PsiElement(.)('.')
                        PsiElement(identifier)('request')
                        PsiElement(.)('.')
                        PsiElement(identifier)('uri')
                        PsiElement(.)('.')
                        PsiElement(identifier)('args')
                        PsiElement(.)('.')
                        PsiElement(identifier)('names')
                      IndexAccessImpl(INDEX_ACCESS)
                        PsiElement([)('[')
                        PsiElement(BAD_CHARACTER)('*')
                        PsiElement(])(']')
                    PsiWhiteSpace(' ')
                    PsiElement(==)('==')
                    PsiWhiteSpace(' ')
                    ValueImpl(VALUE)
                      PsiElement(stringLiteral)('"token"')
                PsiElement())(')')
              PsiWhiteSpace(' ')
              PsiElement(or)('or')
              PsiWhiteSpace('\n  ')
              InExpressionImpl(IN_EXPRESSION)
                StandardFieldExpressionImpl(STANDARD_FIELD_EXPRESSION)
                  PsiElement(identifier)('ip')
                  PsiElement(.)('.')
                  PsiElement(identifier)('src')
                PsiWhiteSpace(' ')
                PsiElement(in)('in')
                PsiWhiteSpace(' ')
                SetValueImpl(SET_VALUE)
                  PsiElement({)('{')
                  PsiWhiteSpace(' ')
                  ValueImpl(VALUE)
                    PsiElement(ipv4Cidr)('93.184.216.34')
                  PsiWhiteSpace(' ')
                  ValueImpl(VALUE)
                    PsiElement(ipv4Cidr)('62.122.170.171')
                  PsiWhiteSpace(' ')
                  PsiElement(})('}')
            PsiWhiteSpace('\n')
            PsiElement())(')')
          PsiWhiteSpace('\n')
          PsiElement(or)('or')
          PsiWhiteSpace(' ')
          LtExpressionImpl(LT_EXPRESSION)
            StandardFieldExpressionImpl(STANDARD_FIELD_EXPRESSION)
              PsiElement(identifier)('cf')
              PsiElement(.)('.')
              PsiElement(identifier)('threat_score')
            PsiWhiteSpace(' ')
            PsiElement(lt)('lt')
            PsiWhiteSpace(' ')
            ValueImpl(VALUE)
              PsiElement(numberLiteral)('10')